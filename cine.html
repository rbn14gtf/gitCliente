<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Cine</title>
        <script src="./scripts/cine.js"></script>
    </head>
    <body>
        <h3 id="entrada"></h3>
        <script>
            const peliculas=["Spider Man", "Superman", "Dragon Ball Super", "La era del hielo", "18videos"];
            const regalos=["Agua","Caramelos","Palomitas","Perrito","Refresco"];

            let p1=new Persona();
            p1.name=String(prompt("Introduce tu nombre:",""));
            //PIDE EL name Y COMPRUEBA QUE EL INTRODUCIDO ES VALIDO
            do{
                if(p1.name==null||p1.name==""||!isNaN(p1.name)){
                    alert("Nombre no válido");
                    p1.name=String(prompt("Introduce tu nombre:",""));

                }
            }while(p1.name==null||p1.name==""||!isNaN(p1.name));
            p1.age=Number(prompt("Introduce tu edad:",""));

            //PIDE LA EDAD Y COMPRUEBA QUE LA INTRODUCIDA ES VALIDA
            do{
                if(p1.age==null||p1.age==""||isNaN(p1.age)||p1.age<0){
                    alert("Edad No Valida");
                    p1.age=Number(prompt("Introduce tu edad:",""));

                }

            }while(p1.age==null||p1.age==""||isNaN(p1.age)||p1.age<0);

            let precioEntrada=10;
            //const regalosRecibidos=[];
            p1.regalosRecibidos=[];
            //PIDE LA PELICULA Y COMPRUEBA QUE LA INTRODUCIDA EXISTE 
            //Y COMPRUEBA QUE SI ES LA DE ADULTOS QUE SEA MAYOR DE EDAD
            p1.peliculaElegida=String(prompt("Introduce una pelicula de las siguientes:\nSpider Man\nSuperman\nDragon Ball Super\nLa era del hielo\n18videos",""));

            do{
                if(peliculas.indexOf(p1.peliculaElegida)==-1){
                    alert("La pelicula introducida no existe");
                    p1.peliculaElegida=String(prompt("Introduce una pelicula de las siguientes:\nSpider Man\nSuperman\nDragon Ball Super\nLa era del hielo\n18videos",""));
                }else if(!esMayorEdad(p1.age)&&p1.peliculaElegida=="18videos"){
                    alert("No puedes ver esta pelicula siendo menor de edad");
                    p1.peliculaElegida=String(prompt("Introduce una pelicula de las siguientes:\nSpider Man\nSuperman\nDragon Ball Super\nLa era del hielo\n18videos",""));
                }
            }while((peliculas.indexOf(p1.peliculaElegida)==-1)||(!esMayorEdad(p1.age)&&p1.peliculaElegida=="18videos"));
           //console.log(getDescuento(p1.age));
            //DESCUENTOS
            if(p1.age<=17){
                p1.precioEntrada=precioEntrada*Number(getDescuento(p1.age));
                p1.regalosRecibidos.push(regalos[1]);
                p1.regalosRecibidos.push(regalos[4]);
            }
            else if((p1.age>=18)&&(p1.age<=25)){
                p1.precioEntrada=precioEntrada*Number(getDescuento(p1.age));
                p1.regalosRecibidos.push(regalos[2]);
                p1.regalosRecibidos.push(regalos[3]);
                p1.regalosRecibidos.push(regalos[4]);
            }

            else if((p1.age>=26)&&(p1.age<=35)){
                p1.precioEntrada=precioEntrada*Number(getDescuento(p1.age));
                p1.regalosRecibidos.push(regalos[3]);
                p1.regalosRecibidos.push(regalos[4]);
            }
            else if(p1.age>=36){
                p1.precioEntrada=precioEntrada*Number(getDescuento(p1.age));
                p1.regalosRecibidos.push(regalos[0]);
            }
            else{
                alert("ERROR");
            }
            
            console.log("Nombre: "+p1.name);
            console.log("Edad: "+p1.age);
            console.log("Pelicula elegida: "+p1.peliculaElegida);
            console.log("Descuento Obtenido: "+getDescuento(p1.age)*100+"%");
            console.log("Precio Entrada: "+p1.precioEntrada);
            console.log("Regalos Recibidos: "+p1.regalosRecibidos);
            document.getElementById("entrada").innerHTML="<fieldset><h3>ENTRADA</h3><h4>Nombre: "+p1.name+"</h4><h4>Edad: "+p1.age+"</h4><h4>Pelicula: "+p1.peliculaElegida+"</h4><h4>Precio Entrada: "+p1.precioEntrada+"€</h4><h4>Descuento Obtenido: "+Number(100-(getDescuento(p1.age)*100))+"%</h4><h4>Regalos Recibidos: "+p1.regalosRecibidos+"</h4></fieldset>";
            
        </script>
    </body>
</html>